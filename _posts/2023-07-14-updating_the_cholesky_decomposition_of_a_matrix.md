---
date: 2023-07-14 12:00:00-0800
layout: post
title: Updating the Cholesky Decomposition of a Matrix
---
Sometimes, we already have the [Cholesky decomposition](https://en.wikipedia.org/wiki/Cholesky_decomposition) of a given matrix and wish to update it efficiently when that matrix "grows" in size (i.e., through the addition of new rows/columns).
Instead of recomputing the entire Cholesky decomposition from scratch, we can compute it incrementally.
Moreover, this incremental computation can also be strung together to retrieve an iterative algorithm to compute the *full* Cholesky decomposition.

## Algorithm

Let $A_n \equiv (a_{ij})$ be an $n \times n$ positive definite matrix with Cholesky decomposition $L_nL_n^*$.
Next, consider expanding the size of this matrix (while maintaining positive definiteness):

![](data:image/png;base64,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)

The notation $a_{1:n, n+1}$ signifies a column vector with $n$ entries.
Suppose the Cholesky decomposition of $A_{n + 1}$ has the following form:

![](data:image/png;base64,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)

Simple algebra reveals that

![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlIAAABLCAYAAAC7mWkJAAAAAXNSR0IArs4c6QAAIABJREFUeF7tnQn4dVVVxl8TEXLCsiACUdS0kkRTE0MryCkHTK1IVBLnMEPULJQsRcgBFdHUnFLLocgUEU3TctYIs1RUpBCEUkxNcwg06/nxraWb851z9t7nnnPvPfeu9Tz/5xv+Z9j73fvs/e41XkkhgcByEDhE0jsk/bSkDy/nlfGWQCAQCAQCgUCgFYH/k/QHkv5wUXyutOgD4v5AoACBa0t6n6QXSnpuwfVxSSAQCAQCgUAgMCUC+0t6l6STJT1nkRcFkVoEvbi3FIEXSLqapAeU3hDXBQKBQCAQCAQCEyPwMElPl4TF5Oyh7woiNRS5uK8UgV+RdIKkQyVdVHrTDK67saTDx1ALz6Cv0cRAYCoEdpf0zakeHs8NBAoQOE3SbpLuVnBt6yVBpIYiF/eVILCXpHdKepKkvyy5YUbX/J2kn5e0p6RLZtTuaGog4Aj8haSrSPqC/VyWQPOrko6W9PcTwXVPSX9tzz5M0umN9/yEpOdL+oWJ3h+PDQQcgVtIer/tU08bAksQqSGoxT2lCLxI0i6SHlR6w0yue4ikP7G2HiDpYzNpdzQzEEgR4ICD/Iak69nfcb51WdgJtwPugyS91cwp+0q6WaLZ/SEjdRxSWD/Q/EKqzomhCwQmROAkSY+2OQmpqpIgUlVwxcUVCNxP0qtsYqK92SQ5S9ItrUOYLNG6hQQCc0XgK5KuOVYEUwEI/yDpnyThnwKZu0DSn9p9RFKhBXuUpDeYE/ATJOFnORWxK2hyXLLhCEDgPyDpfEl3qO1rEKlaxOL6EgT2M3JxrqS7lNwwo2s4tdxL0sHW5vtKes2M2h9NDQRSBND2fNz+AzPaVKY8fyffzl9J+iVJb7GUKMebacWvgTg9RtIekj4jCQ0wqVNCAoEpEfhNMydD7p9c86IgUjVoxbWlCPyxpEdIur+kPyu9aQbXQRDZdIg+fLWkq0o6RtIpM2h7NDEQaEMAs/tL7Bc43F46MUw49mLKu5Gk21palOtI+mLyXny3CFLhW8MH8RkWWTVx0+LxW44AkeW4aWDm/skac3IQqS2fORN0H5+Hf5F0saSbTvD8VT4SzdN/S3qopE9LuqEknBN/d5WNincHAgsg8Ao7GJAkl2S5UwrmcMzip5rp7pl2GPmt5KWY9ghM4TCGZgBtFLnnPhSmvSmHJp5tCJAK4XE294q1UkGkYv6MjcDvGLkYJWPs2I1b4Hl3kvRmSdjSv2ymBnKPsBHhrBsSCMwRgX+VRGLC50lKCc0UfXmWOfTeww4iOPXieP6plpfhbA6Riqi9KUYintmFwK0k4cP3UUk/VQpTEKlSpOK6UgRwIj2wVjVa+vAVXseJHXMep2gE59gjJb1NEiQrJBCYGwKpf9SvS3rthB3AmR2fyWtJ+gFJLzMn8y5tLkQKnxXSMIQEAstEgAMzPnz483mKjt73B5Fa5vBs/rtY9F5nqvlNWgBZ7PHn4CTt8lJJR5mp4tabP7TRww1EIE3jcV1Jn52wjxw2SHlwph1IyBF1fdPuTvjaeHQgUI0AFoaX2zw9ouTuIFIlKMU1pQjA3km0B4nalAScN7BQbT6oNyVAPFXScWaWuEkpQHFdILBGCOBkjrP5eeb8PWXTTpT0e+Ybhc/TfSx6b8p3xrMDgSEIuNP53pbDDPN3aKRyIMTvR0EArQwOoZSBweF8UwQTHpnL8f1KBf8N/MD+QxIfXEggMDcEPGDCnb+72s8J3fM8De2j+0NdaL6GmO1CAoF1RcCdzrFGZLOdh0ZqXYdxfu16tqUCQBO1KWY9THlvzAzF1yVdfX7DFS3ecgRS/yjP6dQFCYejfRbEC7Mhz6AiAIk4QwKBdUbAU3P8oyQc0HsliFQOofh9CQIQCdSfPyzpWEmQqk2Q90r6c8uq3OwPCQPd8Zx8Ummdsk3oe/RhsxEgQg8TG9K3D+CEfndJJJ5dRDxj+bpE4eH8jt8WhLImYzpkEHPou5aQvHQRvOPexRC4hpUqYm1nnhBU1ClBpBYDO+7egYCzd/5OAUgi9+YumPJuZ5tIW1/YYIjiQ9ocdcmhheM9flRotcjwzj2EekPOyNgcEgisCgFPeknONxJkdgl+gczjNLHuI+2bP8GSFpKZnJw7JM7EmbyZHd3N4Pz/1ESKZIp93xZtIdknCReR0jQt4EUkIelPkGVkgV/V3Ij37kAAbRS51cgr5YfmVmyCSMWUGQOBh5vWZlP8o37EPiLSG/xtB0DkGPln+x2qXz46F0gUeUgwcbIA44DPAk9CT7e3P3AM4OMZgcBABNzURj1MMvW3CXOXWpJkIf+SXcCBALJEwsyfseS77zYfKrSyRONRRsnlleYzyQn/25Ju03gR5GTMsjTU9ewja54xHe0515YSKe6jnfh2cU8QqYETb0a3eYqbvm/k8u4EkZrRqK5xUykoCpkiDw1al7kLGwgnz9zpGXMFQjmcFyadJvHglU0zRxjtj0r6d/s9J2LMn+TTCQkEVoFA6h/VRiQOkISWCfLAZpKSfhzUD5d0NyMUaSmNT5qJ/65Jp5zYsEZgIkx9rVxTNeY+lCNS3jQIXA2R8vu8zUGkVjFzl/tOd9+gbAzfRKeMOYGX28V42zohQLQeUXv4DpBob45CTihKv3D6JmEgQq0vnOdTHwoimNBUcU2a+ZbT6jmSjjYTAPdzHeZBSsm4cGJHO5VuNnPEK9o8PwQgDgjzjx+kqQ3CzHftpGvMUzRQLq5B4rBBoEVKsthwmt+L3+eaLLS0mP7JpA6p4t98Ny4QFdYSCBzPeo8VCH+Omchz2qtVEimIJ+KpX8gYj7/oFyRxuOLfd5REbcEzEteA+c2k7Wixk216u5ekz3d1O4jUdkyIKXuJozn15xBqaZ095csmfDaLICf1plACJvW56LqO+9gQ0vxZ59umQYZcF1IpcNp/0YR9iUcHAm0IsDEwx93PpwSlNkdsfAIvkPTbicO6a7n6fCTxrcL3kDqcBHLge5LKwZJ+0CojcKg5XdKLJVFV4Kvmq0US0T6BaNHPnEyhkXINtWur8IfEd+zBRljJT0R/cAXATxIzJ4fQkPVEAHM08w7pdTgPIrWeAzinVqWO5pwwWSRDdpz4IVKp6cQXb3ywCAGPyJ+YKXNEwH0iU/MWmqTDLNiEv9dEwjkGEBES4N7fyBA5fJxofMRKzORSq9QSKcgdWuJS6TPtQf7wE/OcW/SHPZZ14H2S7mcvQUONiRTtNb5mIeuLAGT4x+wAQDBFqwSRWt8BnEvLWAxQ0yP4BX1nLg2fuJ1eZiDdbFiwObnzfyyyhGC7Nm/i5sTjA4HREMD5ltxTaI9c3KyHBvcTknZf4G1USCCdymOTZ6DJRbvjaw2EBk3Pro2fXSR9ywgNpOZS+ztm9tQs6Iea2ioMtT5SFGUmGSnpIwg2QXDGx9SHsz4FckPWFwGv1nGa+QwGkVrfsZp1y1g4ifrBfowdOWQHAiy4nEDxuXLh/zhtEzFFBNMdAqxAYIYI4IeE5tk1LHSB/2NeM7/xNyTIYqh82ciGa3ac9JTUA8RvCxNaTpZFpJw03dg0ao7VbpIgWSHrjYAnmiYj/35dTQ2NVNkgokVAm5CL4ip72mZdxemTWnOkAjhws7q2UG+YM0Trvb3xlJtbodbII7UQvHHzChHAT/CDjSLHkBfmPATLI1SHNNF9rfhOMOchrL0cSHDUzpkNKdmE6TwnyyJS5JrDv8a1dxw2aSN1BwnMIUdX7Cu50Vrd749JEkx3Opx3Eamcs14ucmJ13W5/89D+4JRJxAX3c8KiWjkfehplsm59XWZ7XI3OO6nsTmROSCAQCAQCQxEg8hffqFSTi1kPMoUZjMSgqUmx+R58WtD+5KSPSFFnDdM82d8hOqn0mfbQypEJG79RF9pzVqK98/eyj6CRJkJyiD9Zrn/x+3EQIAcg5j2E8WrNK9hGpJw07CGJn1QIB4dYzI1B449ChfM0DJ1+eX8I4W3TEHAfBOHxFp3Cx8xHhso5Jv+O6B8WOQSiiUo/JBAIBAKBoQiQVuFzkh6VPMBzsbGRkWmaKL4uITEu0cNdwv4GGUL8gO2KAd/X3JxzcuKnxT2e2ZzcWb53sA/4/RApIr38/a5dwwRKlB6CtgyNHaQQE+adhwIV9y0FAfzY0L4inf50OdPeuXYy2JRCkx6eWtOfp5jHPmDe3vKmLFoJfSkzYAkvIZqBExdykpVDWcJr4xWBQCCwoQhg0msrMVVqCSjNI1UC3xjP6srcXtqfknbGNdMh4BGWvIFIa7jDTtJHpJw59zKx6do/+pOH9gct1L0tEzV1qWCoITsQSNk6+WE6w0MDsEAgEAgEloAAJrkxDrpooEiciXkvZHsRIPHyF637mJy9xNcVEOkjUpQAoGAl0pvVcyYYp/2hzhImypx4xXKy6mLSe6KZ+cAlTHs71NJvMRA72XoO5Ph9IBAIBAJrhAAVC3DpwIyIY3jIdiPglixIFGRqJ+kjUu5Ul6sOPheIvT/kJ2n6SnX1IXU25/65+YZNPTbU1SMqBaH+VtMxc+r3x/MDgUAgEBgbAa9wEEFFYyM7z+d9w/KidboE9REpr3FE5lWSLs5dvD/ZSs4tHXUHxSBSVwSHSuieFZgEfa6dmvtcifYHAoFAIBAIBAIggGkPEx/lv1oz63cRKZKFfdMwpE6Yh//NFda0P5Q3iDpn44zkEySdYI/6WcvgO86T4ymBQCAQCAQCgcDqEbjIcgKS+qA1iXIXkXJ/IvyIqH009zIWqX/UAZIoZ7Apghraq44P7dNQf69nSnqMvXTTcB2KZdwXCAQCgUAgsDkIUBcRd6Czu1JrdBEpnKup7I0mKq1cv27QdIWWNtvp/flSJpnbuvWvpD2rJFIvTXJHlZRvKOlPXBMIBAKBQCAQCKwLAlTtIADh30yxtFO7uogUGhuSjqWV69ehUxAnNGREU1zPKoOXaFO8PyRFS+tDrUOf5tyG10v6ZesAyVu/MufORNsDgUAgEAgEAoEGAuSQJNUPCVTxlSoiUmm+pbtKOrMD1j0tWziFF8cyleXqKPF70v+TSRY/pxKil/YnzTDb1i2yzZIPaW4lcFY180lY59mBc8ldV9XGeG8gEAgEAoFAIDAUgew+17b5Ub37lQVaBvIp3F0STsZjSY5I+Xu8XlEJkUr7Q40mzHttgh8V5IxCs8sW3klJBMIsSzRsy25f1/tSjdTukv5nXRoW7QgEAoFAIBAIBEZAAN+oW9RqpF4iicKR1Cy6VU8jyC9FBtlnJddAVPa3Io38N/8+UNI7CjszBZHy/uTyR1EME6eyMYkMTuCETHYJvyfR52WSKLdSQgybz1oXHymKb/5X4TjHZYFAIBAIBAKBwBwQcGfzKh8pzFsQqBMlEd7eJhAeNChEalGAEYEUUHDSicPzJF3N0ihAuO4hCfLVJxAJfnJSo5Hy/vQ5zhPS+DZJtzG/q9z7S39PRtRSkxfXzo1IpVF7e0cW4NJpEdcFAoFAIBAIzASBz0uiGkpx1B6OVBcaASL5ZJuv0KmSHimpmajzvWYSxCcJQrCvJPIvINgYkVxCS7RBXpm7D+NSIpX2p4ukeMbzDxmRGnNsl0Gkxmxv7bPSPFJoIs+vfUBcHwgEAoFAIBAIjIwAdRLx8caX+1xJb1jg+Z7ZPJtHyskLkXAUfUTaNEMQGHcufoAksoS7oI0i6+cHbEO9b/I7iBQVvY+1/8Mcxbtc0FxBOm4r6ePJ/+Nz8zVJb2yAkCNSaMf8HaX9aSu6S72la0h6sZknnyvpntYeIgD7zHY0edOJVJrZHLw/scBkjVsDgUAgEAgEAoFFEbiZpI9Iwj+aKH+4zNvNZemzlQ+/irnecFs2s7lrjGreAVFqFnTEvHOxRb49wx5GvbpLJB0q6Z32fxAhiNiP289VJfGDtssJyLck+U9TS5UjUvRnV0mA4D/pv9v+3jTBUfX7SKv2DElEY0XyyfdJwqSF/9cDM4BtOpFKa+3hjAdZDgkEAoFAYJsRIAfjKdsMwJL6TuodfJ+bLkP4bcMB3mTtOEISPtBopTxdT2kT2ef/0y4eVGuv9EXpdWikKFybpk1Aa4EJiMg0tFCf6Xnw2Ka9IX3we5wEQeLQal0/edjLrS85U+WmE6k7J/X1xiwRA644+LlpeJFxjHvniQAJ8L6aWS/m2bPxW02OG76Xrojk8d8YT+xDoGbd5zkxfsPmE+sDCo9XNG4HfyR1T6JeHhau2qh89n2czJGnSSJbwU5S6ghd2k1MX3QsjeCCGX5Y0u9b3il8qLpkCmfz0rZ3XXe6pAusX37NeZJI0uXJPSFbd5J09cYP0XhoxDBPUmaHP/nhtNI0Cw51Nl+0f4vczwIADsgYRYvxqyMogOLHT6xw1F+kD3O7F7M1h5M+yRF81/COGaE6Fo7MAcYf7TYL2C3HevAGPodvzt0OKOfl5ZrSrrKuHGya9A2EYC27VEqkSsZvLTu4Jo0CZ5QcTSLFdwBxIsjNBR5CZHwtkXIzIc+BREGmdpKxiRSNpdgxE8QFB2T8jzDlvVYSvkVdkiNSmPRwICda0K99lz1sqiSaXzcS9TJ7j9ftK4nw4178v0pkjkSKifkp6xwEmkjNoYK59c2SPml4ly5GQ9831/vc/4/2EznL99D0Z+wiSI+Q9IIkoIPrSsssLQOv5hxgPaGNU33by+jTVO+gugPfy3GSWJtwmzjEXnYXO/ydI4k1aD+LOqJaRc6vc6r2btNzS9auvvHbJqwW6SumNlxtmkSq+UywJp0Tvtb4ONcIh5D32A0Pk8Q7d5KxiRQnXfxk0OK44IRMoktOTp7os6sjuTxSLPr4LTXJCQ7qU5yuIWzYX29uzmu0m37AaiGLfDAw1q60DviQ9WngUhzmSKTc/41+UM/w0TUztHHt8UagmPQ4BGL7xlEwpB0B9xPktyVmVczqBIK80B4HaYEIY0JDm9pncl/WGHDie5zlnmMOoMWl3ZwuQ66IwGmSvt/WIYgTBPsouwTXA9wrWCufKunxkl5tFShy2sptxTnndlKDSwmR6hu/mndt87WlRAr+8dCBFo7DJb3GQMZ1qfUgMjaRWnRQc0Rq0efX3k+UIaf4GyU3okJH83KWsdN9eh6KtoaSNiUyRyK1iwUE0D8c+8gVNkQwBWP+/RtJD7foTzSYaP9C2hFAfU3QA34C16oACUdMCO/nJP3RmjnFciDhUEQQAxJOu+0Di7mT9Ydx5ACDlhEinJodHmzfz2H2CP5NkfGQdgTG1H7miFTJ+MU45RFAqUHapT6N1DGSnj2QRNECDncnWVPIN0kKhJ1k3YhUHrrlXoGvBn4aRyev5bSHA9rPWdr4vkg1Fru+7PCpViHtGaaMuZwcSXlwE0mYETAdDBEnBWhGSIwK63eT8JDnbcM9aBggHJBPnP5LhIMKGiiSy6HFoqo5mtxFcqyUvLfkGqKAMfujVeEbC+lGwMkw3xt5/zCHs0Z5mhivdkD4NwLRZsNhrAkLD9kZgWUSqdz4xfiUIUDVEsxuXUQKTS1m71KrUNtbOaRwuEf2kkRyzp0kiFTZgA29io9zLoRoaB+ZxGiPLpW024CHkPYCbRS+HLe2EkNoJXBkz2XCH/C6jbkF0xfa0NJs+JB2NKlE0HKyopwPRIrUHl3Jd5cJ1hlmjsJsTrWEPcz0SGWCkO8hAAnmu4BA8b1ApkmQnNY8Zd1hfJkbpG3huyQQCFeFTV+Phs6VZRGpkvEb2odtu6+PSKHAwI0BVxGXnKawDT+UKRxU+d7wNWyVIFLTTj0iCtLIgWnftpqncxJ2J/Prmn9TTUswnZIlH/UrplTPP4avTEg7AmiVIEFISdBD8ynrFrXnDp1sZjhMo5Viw3eNSsyD7yHgpgon0CQa5NTtfhxNrNg82LxxSQjpRmBZRKp2/GLMuhHAVP3uFo3UQRbg1tS+NtMYlWDrFhd82vBDDCJVglpcU40A2eiJnECGaDYwOXCa/jVL3EpkJ9ooUk6EtCOAbwzmAfIGkTCuVtaNSLmp47EWiUaRc5LdYuYNuSIC75fERoE2CgL6i6bJ68Jp3fxO13U8l0WkasdvXfFah3Z1ESlS6LRF5w1xmSELARrdtson38UgNFLrMB3m3QZyZxFdhfROto5u4ixNGR78zrBH47SOhiqkGwHMcZyO8CnyXGZzxovQZFTw+PY82RzhSacRckUEMOVi0sX0yaGFQwiZmv0gE3gNR2AZRCrGb/j4tN2JJpb0R00fKS9j13ZPTSoVfKK8eov777b2IIjUuAO7rU/DD4MTcmctog5giGjEUZYIMuzZ5EQiUmuVgmMijty1viSe32mKNBxNPNDWYUZ9kJl1VonXou/2zYXnPMWc4WtzvSzahub9zAHIfG05CcggiWRr7yttv5dkgkCT6JdDB6UvQhZHYBlEah3Hb+o5O3RkStrVRaSGvrN5H24TpIxBOh3N+WUQqbEg3+7neGQDpIj6iaVCugQijXDoIzcYkZBTCJoOogr7BC0PHwv+R0Q5lXwbkCccETGvEWZe6vi9SB+paXi2PYBoSU+I2nwmmkLC4dOI00XeO9W9Pgd4Pk7U5GVblTAHIFCYwzjVlswB2vp008bijzTEfFDaXzeBcmDB/+PE0hvjusu1nZ0+LoWJaUsOScyZ73TMnWWNXy7JLr/HV4v1DjeKKedsOvXAvy8hbG27iO6l7bmEnEOnv/uzfcwCNTqfU7pQDG1I3LcdCBAeCplCahxbKXXy/AV8fUrRLfET8Y+ck2npJso9RBhex1TMyyBSjhmFNEmI2iX0mfB4ksits3h/MFfVlm+o6Rd4kI7kzJ6bfA7gm0VkY+n66BvX1ETKTbocPNLqETU4THFtyUFlivfWPHMdiNSyxg+/nt17wHHTFyRk6jmbNiMXxV7brqmJlPtavcoi04NI1XxxcW01AqnDObk73lr4BDY3yMcQJ/XCV1x+WQmR8ufVECm/x1XAyyBSrzfTER/5vTpAIKUE2h1P1liD1bKv9TmAc/mUEa4lRMr77qkYSomU3zf1pjRkbk49ntRQhazftOJFEGbKG31joooUFU357qVjmfb6NFLLGr/aihrL0kjxnj7/pXTcSr6lqYkUhzvM/ESQk/w4iNSQLyvuKUYAMxIlXdBGZSedPZWU/WyekBAczftKlFCih4guSoWwALNwUwKDkG5qjPVpGXgdSVX3L+zNkMWO9pELq41IsXBgssQp0h0d2dQPNPMM5gIv9k0fcbz2+pFtTcafbE/LuO/lXprXgS3vIG8QkX3rKl4Di/blyDRaP9JsfMU2XyJp8GWjojulIvh7n5wgiYip3FzhGU5WxyRS+LOxwfn7eQfznmSozAHGi4zXJPilnc3DCM6upDigCkBtu2rHP3fwYE7jmwVhd7MH45MTnosGEheA2y/JFJ5rk/9+aiJVM37NucGBiCoP+KKS7iJ34GCdLI3mLSEsjlHbnGXtQ9P7OknnZcCeE5FiffZk272O5vR56g+ydBLHdfNHgDxQ2JT50O+Y6Q4bPTmCCHNnceWjTzd8/KVI0OkCYWIy4xtEWRP8nUjVTx0knHtzi8YlRvJKUB5CpPALo01tRMo1Lv47Tu6UHaDgLJv/qbYIEXnFAvktSQ/paGiaP+qGRl7bLmVxxB+DjPHrKow/tTdxwIUgYKrCZNUlXzZ/NMYfbRsECnMyY8+YMQYX99wPWWUjKInaoT3Mrdr1sWtT8jngJ38n3pBH2o6vE33H74kxu7uRKu8O93N4wLmcunnU2MN84zK2aY1kniRELRHaD4mCtJeKV3RYhga3tE1TEqma8XNs0rmBwzPkmoMTB0IId58QRU0kdImUEqm2OQvZh2ywhnG4y5mbOSCW+sGWtGtKjRRJbukXB9u+6iSXY1y7UJQMTFyznQgQtceJCcEhuq90DqcrSsDg7AghojyIJxR0LQURfedKup0l66TyNpMasoEmC/FFx6/tQh4TAptPiQwhUmgW0HrhdMxGl0pTI8VmSo0oyCLFNFMCwb8pJNwVMUhKAAhB27eLvxQ+PvicIW2JOnFO/3ZyctxX0jXNz6sEmzGvoUgsCxSJRXGYZ+HytuMA+8EGMeXf9Il5A+n0tA8Qyk8XaLSYNxCptKB6V388W3/t+ti3+HPIoLwE85wxhPRBDhlzfneKNYZNl4NG6i+GFod5w7cB+UwLpTPmzCfmTN83VzN2tJONsUT4XpCaKNdtI1IkgiRDf8n48Q1w8IN0gG06N9BMMd45X0KqTKAtLJESwsJzauds27vnRKT4zjjscehNa1i2Ylq7UJQMTFyzvQi4c17NSZONDZMHhSExcVBu5t626YGkO/J6EkocqD0CjwXq5IZGiky3mBr54VTmf+cE/7XkB40Xm1hTTT6ESGFHx55OxFcuSs77g+Mpp/g0ypEsupg90vB5SAVaGApnNxdQ165AytBK8CfS5vPgjq7gwMJAuQMWNjZlEjtChFclrllC6+IkBqJEmL8LGwhkFTKdEm8PdODE7JmM6ZePO3+CC3/+b8scIFjAibm/C2JCkd/a9bF0U0rnAPinhc05ZaMNakuhQHqQj9p3wiHDSTtmQ+afC6QME7h/h2Rl5puCuPG7XPQZ12FCLJGxiRREEpJN+z0/Hd80fSc9BrUlCQZgHpNTa6w8alNqpBxHHz9M0aw7x9s3nY6fm/whz6SC6Zsb4ISJNZ3rPt/bNK98W831boo5S7v4dpvrMA7w6RrM31mHGcOma0dJu6bUSLEWo/1jXcVtpVdqF4rc8+L3240AGyG2ck7GaKVKBI0CpiwIBQkGWWQwLTQFMxhq4ZRMeA6d3GI6tWmPBRK/hGx0R9IpNgGuP87+zx3W2UBQKbuwGOHAnxNMgv5zWYsJy+tMsWEwNmjCPJEjv6shv7m2DPk9Ji383jAXUEOrzbcLTQ1On8wB32TR8GDqgGj2CRs0BLwv/NrvB380ZLXrY8nin7aROUDRVYihCxo3zLLpHEjvYdy1GII9AAAHC0lEQVQgRbtYjpumn9yhpuV10xAkhL6zseKPxfeWcwxnc3NSnhvLsYkUmyMHJCfSbMjMZzZa5gd/8s3gj8M64z5muXbmfr8MIkUbGD9IMuOHG0SXbx9rw5Ur54b3MRcdl2KxjDnr72Mu4htXIiXtmopI0UYOY4zNESWNrV0oSp4Z12w3AixunKrwk2KhGEvYYNA4+EmdUw+OrmiwOOkQOdilDXKzUElbhmikMBuy+fRF0qXvpu30JzW/odLnFIqmCE0DG36JP09Jn7gGjRTO7CTz5E80eYibWSDBJSSj9H1TXAfBwsnciTPmTEgyGjs0LWg1m9olb0cNkaLeIxjVro8li7+3x+cAmlZMNghaN8YJU/GRjQCFUjy5n3HEr5C5jKYRZ2CE90BGcqQTQk7CzxIZm0ihRYYMQpAQMAUP5isHltSE2DTzlrS365plEanSNkIUCa4YMjemIlJ9c5Z1i2+vL8XIXEx7rtElKpo1PSu1C0X2gXHB1iNAmRhMRywCY5X58A841dZ4sjTmMBluOT3gb9UmnGqLTha2+bTlkaINLFCciJv+IN9nZqM2R3u0KJgQ8fFC24Zw4mZjZ4Nw4dmYnqidRgRgqUavZsKh+QCLNEIO8gYR2dvU7jXPW/a1EGc0Um6ecBKIEz4O2pBZ9zVqtq2GSGFCIoihbX3sIw5dRArfGMxrEGMneswBTtSpSZJFG7Me4+MEoi+atQ9/+tt0Wkd7h7aXQuEI+DFn0e5hZvE/8dNrczZv01qOTaS6+gRh5rDhZknqc6LBHittBt/3UKzTNvelPyj9XvBlxLQ0dG6MQaSc1PO9eQH5rjkL+WXdwt+xL6HuHIgUyZgx96MRZ10pkiBSRTDFRRUI4MBMVBWLMgsCjt6Lim+YnKQ9xJaPF38iCMCx5pDe9R7qt5Hvpk98Q/ANxrVBTppog/vsuHmR//MCwO734hEzfp8vSKnGJ90wvU04c6JVY9PlWX0pEIbiiQ8XmygO5m4aQ4PB5grhy2VEHvreMe7zcOSUBLpvGtGcF/bk1eL9rqnp07r5HEDThS+ezwE2b/+71wWkRA+mOcTvSxMK8v8+B1iQicpj/nDQQHgmkahoJV0IwsCsRxoRTIuLlH+BdGK6hcAjaE3RUuGPQ2Hw3LdQ6jy+DCLl2fxT/0gOa2CZS50yxtyrecYYRApt6H0acwMSg0mTNRDNe1890hIilZuzrGu8E5cFjxLsmrMQbNatXAqTkvQHuXalY8FhgzaOmdn8KEkUQ6b/7BtFEkSqCKa4qBIB37AJbc8t2qWP5kP10ijpPWx6bBB9ksuLU9oGrnNfo5p7mtey4dIXJzP++4OS2k6LPL/rXgguxDbdvOkPphQEMpfzn5miXaXP7CJ6OOR2lcrxZ5cQqdJ2QOYpbZMrO9T3PMgVpqnmHICk96VxKGkj84hweRzm2RQQ0jmgueV7YaNO85o1n1myEfs9XUSKgw7fbJt5ui9qj/bxk2LrjvOY9lw4ROFwzziM8U2W4FpyzRhEikMDDs7NuQHBJuo2lxuO6GmCVMaQFNuuOVuqzauZVyVtn4JIkZYGP7aUtGfbEkQqC1FcMAAB7OUkymSjQOW7asnVeKpp3zot2jXt5tqmU7mnmmDRwDRKuC9RYZsonPDZnBchP47Lus+BtghXNrFdJWESo/2pVnIKIuVmIHx8aE8qfUSKKF5MkmlkJgEsN2jkT6IPaFHJI0aR6/RwsMr5OwaRWrT9Yx0cPa3LWDxhrHY5PmiEMcGPpZHC9xIn/yptFI0ZC6BFBz7u3zwEfFISjYW5YhOExRvT0LrXr+vCms0ULUUazssmh+oeIsVpLKQfAdT95DYrNX2tAk9MMJiA0mhA/J6IEMRUgyO7O6C3ta9Ec8C3wEZGZBkRaPygMfI9BbKEmQRthUdq8X/4OaGt4gc/LPyS8Hlz3yc2MQ4+qWa0LarUU1Ss2z5GlK0TBvzO5ixocfEXyqXLWFUf0VTSPhI7Lyrk3UKLi7aPOptVEkSqCq64uBIBnKyJfGDjQRU/dxn7RDV3PLax/dswBy6StM8IgwupwDzl+wypF9rKiPAu3hmyXghsw1x3xEm8ia/XIUaoqkYiiFQVXHFxJQJkLsfEx+mXU3BIIBAIrD8CYwUduIkx9pn1H/NtbiE+lkSAEqGYzWLeBlRM8G2ePsvpu0et4eyKr0NIIBAIbAcCmORwUN5Uv7vtGMXN7yUBGZREImp2kASRGgRb3FSJANFg+Elg4mtGolQ+Ki4PBAKBmSBARF1JbcOZdCeauYEI4HpCPjdMem1R4UVdDiJVBFNctCAC1O3CxEcuHS+JsuAj4/ZAIBAIBAKBQGAwAgTZnGEJiT2D/KCHBZEaBFvcNAABSsZQcDRNqjngMXFLIBAIBAKBQCCwMAKj1Rj9f7CwT8QzRQ7SAAAAAElFTkSuQmCC)

This reveals that we need to solve the equations
\begin{equation}
L_n \ell_{n+1,1:n}^* = a_{n+1,1:n}^*
\end{equation}
and
\begin{equation}
\ell_{n+1,n+1} = \sqrt{a_{n+1,n+1} - \Vert \ell_{n+1, 1:n}\Vert^2}
\end{equation}
to obtain the updated Cholesky decomposition.
Since the former involves a triangular matrix, it can be solved by forward substitution in $O(n^2)$ floating point operations (FLOPs).
The latter requires $O(n)$ FLOPs due to the norm.

## Implementation


```python
import numpy as np
import scipy.linalg

def update_chol(chol: np.ndarray, new_vec: np.ndarray) -> np.ndarray:
    """Update the Cholesky factorization of a matrix for real inputs."""
    u = new_vec[:-1]
    α = new_vec[-1]
    v = scipy.linalg.solve_triangular(chol, u, lower=True)
    β = np.sqrt(α - v @ v)
    n = chol.shape[0]
    # WARNING: This is not efficient!
    new_chol = chol.copy()
    new_chol = np.pad(new_chol, [(0, 1), (0, 1)])
    new_chol[:-1, :-1] = chol
    new_chol[-1, :-1] = v
    new_chol[n, n] = β
    return new_chol
```


```python
np.random.seed(42)
x = np.random.randn(5, 5)
a = x.T @ x
np.linalg.cholesky(a)
```




    array([[ 1.72643986,  0.        ,  0.        ,  0.        ,  0.        ],
           [ 0.00926244,  1.9510639 ,  0.        ,  0.        ,  0.        ],
           [-0.02770041,  0.34669923,  1.02437592,  0.        ,  0.        ],
           [ 0.10163684,  0.60454141, -0.41500106,  2.91668584,  0.        ],
           [ 0.31988585,  1.66212358, -1.17204427,  1.10508656,  0.39447333]])




```python
chol = np.linalg.cholesky(a[:-1,:-1])
update_chol(chol, a[-1])
```




    array([[ 1.72643986,  0.        ,  0.        ,  0.        ,  0.        ],
           [ 0.00926244,  1.9510639 ,  0.        ,  0.        ,  0.        ],
           [-0.02770041,  0.34669923,  1.02437592,  0.        ,  0.        ],
           [ 0.10163684,  0.60454141, -0.41500106,  2.91668584,  0.        ],
           [ 0.31988585,  1.66212358, -1.17204427,  1.10508656,  0.39447333]])



## Iterative method

Note that by applying the algorithm iteratively, it can be used to obtain the *full* Cholesky decomposition of a positive definite matrix $A_N \equiv (a_{ij})$.
The base case is $L_1 = (\sqrt{a_{11}})$.
Assuming each square root takes $c$ FLOPs, the total cost is
\begin{equation}
c + \sum_{n=1}^{N-1} n^2 + n + 1 + c = \frac{1}{3} N^{3} + \left( c + \frac{2}{3} \right) N - 1.
\end{equation}
In particular, the leading term shows that this algorithm is roughly half the complexity of Gaussian elimination applied to arbitrary (i.e., not necessarily positive definite) matrices.
